# Docker環境構築・ローカルホスト起動 手順書

このドキュメントでは、Dockerを使ってPC上に仮想のWebサーバーを作り、ブラウザで表示確認（http://localhost:8080）を行うまでの流れを解説します。

## 1. 事前準備
* Docker Desktop がインストールされていること。
* Docker Desktop が起動していること（タスクトレイのアイコンを確認）。

## 2. ディレクトリ構成の作成
任意の場所にプロジェクト用のフォルダ（例: `my-app`）を作成し、以下の構成で空ファイルを用意してください。

my-app/
├── docker-compose.yml
├── Dockerfile
└── src/
    └── index.php

## 3. 各ファイルの記述内容

### ① Dockerfile
以下の内容を `Dockerfile` に貼り付けてください。

# ---------------------------------------------------
FROM php:8.2-apache

# 設定ファイルを有効化 (URLの書き換え機能など)
RUN a2enmod rewrite

# コンテナ内の作業ディレクトリを設定
WORKDIR /var/www/html
# ---------------------------------------------------

### ② docker-compose.yml
以下の内容を `docker-compose.yml` に貼り付けてください。

# ---------------------------------------------------
services:
  web:
    build: .
    # PCのポート8080 を コンテナのポート80 に接続
    ports:
      - "8080:80"
    # PCの srcフォルダ を コンテナの公開フォルダ に同期
    volumes:
      - ./src:/var/www/html
# ---------------------------------------------------

### ③ src/index.php
以下の内容を `src/index.php` に貼り付けてください。

# ---------------------------------------------------
<?php
echo "<h1>Hello, Docker!</h1>";
echo "<p>現在の日時: " . date('Y-m-d H:i:s') . "</p>";
phpinfo(); // PHPの設定情報を表示
# ---------------------------------------------------

## 4. 起動手順

1. ターミナル（コマンドプロンプトやVSCodeのターミナル）を開きます。
2. 作成した `my-app` フォルダに移動します。
   cd パス/to/my-app
3. 以下のコマンドを実行してサーバーを起動します。
   docker-compose up -d --build

   ※ 「Started」や「Running」と表示されれば成功です。

## 5. ブラウザでの確認

ブラウザのアドレスバーに以下を入力してアクセスしてください。

URL: http://localhost:8080

画面に「Hello, Docker!」と現在の日時、PHPの情報が表示されれば環境構築は完了です。

## 6. 開発の進め方
`src/index.php` の中身を書き換えて保存し、ブラウザをリロードすると、即座に変更が反映されます。

## 7. 終了手順

作業が終わったら、以下のコマンドでサーバーを停止します。

docker-compose down

## 8. トラブルシューティング

Q. "Ports are not available" というエラーが出る
A. ポート8080が他のアプリで使用されています。docker-compose.yml の "8080:80" を "8888:80" などに変更し、http://localhost:8888 にアクセスしてください。

Q. ブラウザで "403 Forbidden" が出る
A. ディレクトリ構成が間違っている可能性があります。srcフォルダの中にindex.phpが入っているか再確認してください。